<!DOCTYPE html>
<html lang="en">

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-5F9Y9HC95G"></script>
      <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag("js", new Date());
      gtag("config", "G-5F9Y9HC95G");
      </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="TFHub MobileNet SSD on Videos">
    <meta property="og:type" content="blog">
  <title>TFHub MobileNet SSD on Videos</title>
<link rel="icon" type="image/png" href="./favicon.png"/>
  <!-- Favicon -->
    <link rel="shortcut icon" target="_blank" href="⚡">
    <link rel="stylesheet" type="text/css" target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index">
      <div class="Navbar__Btn"><span>⚡</span> <span>Home</span></div>
    </a>
                                                                                                                                                                                                            <span class="Navbar__Delim">&centerdot;</span>
    <a href="apps">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/droplet.svg"></span> <span>Apps</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="jupyter-notebooks">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/book.svg"></span> <span>Notebooks</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="about">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://super.so/icon/dark/send.svg"></span> <span>About</span></div>
    </a>
                                  </nav>
  <header class="Header">
          <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
        <h1 class="Header__Title">TFHub MobileNet SSD on Videos</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Sun, Dec 27, 2020</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
            <a target="_blank" href="tag/Vision">Vision</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--brown">
            <a target="_blank" href="tag/Object detection">Object detection</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a target="_blank" href="tag/Videos">Videos</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a target="_blank" href="tag/TFHub">TFHub</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/62a200d58f89438b9d4f8012c096e163" class="PageRoot"><div id="https://www.notion.so/1f4bfbf6df24451b9ea8f4ff7f4f4e8e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">We will use the MobileNet SSD object detection model from TFHub. We will apply it to videos. We can load the model using the following command:</span></span></p></div><pre id="https://www.notion.so/96e76c82b6f54b719093f2735d29e5e9" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>module_handle <span class="token operator">=</span> <span class="token string">"https://tfhub.dev/google/openimages_v4/ssd/mobilenet_v2/1"</span>
detector <span class="token operator">=</span> hub<span class="token punctuation">.</span>load<span class="token punctuation">(</span>module_handle<span class="token punctuation">)</span><span class="token punctuation">.</span>signatures<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span></span></span></span></code></pre><div id="https://www.notion.so/924eac8d1a1b4f1e81cccbe9e56ec6e8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">After loading the model, we will capture frames using OpenCV video capture method, and pass each frame through the detection model:</span></span></p></div><pre id="https://www.notion.so/27c57372cd19466094b9c23eb4e40a97" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>cap <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span><span class="token string">'/content/Spectre_opening_highest_for_a_James_Bond_film_in_India.mp4'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>total_frames<span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cap<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_POS_FRAMES<span class="token punctuation">,</span>i<span class="token punctuation">)</span>
    ret<span class="token punctuation">,</span>frame <span class="token operator">=</span> cap<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    frame <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>
    run_detector<span class="token punctuation">(</span>detector<span class="token punctuation">,</span>frame<span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/965b86962b604678a64e3994997c7e96" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here are some detected objects in frames: </span></span></p></div><div id="https://www.notion.so/f849ef3f9b3d43bb8cde028b743f0ef5" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2697f77b-cf8e-4593-93cf-689ba58e7aef%2FUntitled.png?width=1156&amp;table=block&amp;id=f849ef3f-9b3d-43bb-8cde-028b743f0ef5"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2697f77b-cf8e-4593-93cf-689ba58e7aef%2FUntitled.png?width=1156&amp;table=block&amp;id=f849ef3f-9b3d-43bb-8cde-028b743f0ef5" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f72daa4222bb4ba7a00f898d17580d0f" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8753c62b-b91d-4088-aa3c-884140827174%2FUntitled.png?width=1156&amp;table=block&amp;id=f72daa42-22bb-4ba7-a00f-898d17580d0f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8753c62b-b91d-4088-aa3c-884140827174%2FUntitled.png?width=1156&amp;table=block&amp;id=f72daa42-22bb-4ba7-a00f-898d17580d0f" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/64a0a718a0cc4db5943d572fd7d0a95c" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F14debb19-9bd2-4516-bac5-d6a6343fdb24%2FUntitled.png?width=1156&amp;table=block&amp;id=64a0a718-a0cc-4db5-943d-572fd7d0a95c"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F14debb19-9bd2-4516-bac5-d6a6343fdb24%2FUntitled.png?width=1156&amp;table=block&amp;id=64a0a718-a0cc-4db5-943d-572fd7d0a95c" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/e0b5641961dc4216a9b7fcb29d2de449" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">You can find the code </em></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://gist.github.com/sparsh-ai/32ff6fe8c073f6be5d893029e4dc2960">here</a></em></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"> on Github.</em></span></span></p></div></article>  <footer class="Footer">
        <div>&copy; NotionSite 2021</div>
        <div>&centerdot;</div>
        <div>Powered by <a target="_blank" href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>