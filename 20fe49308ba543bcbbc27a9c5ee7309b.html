<!DOCTYPE html>
<html lang="en">

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-5F9Y9HC95G"></script>
      <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag("js", new Date());
      gtag("config", "G-5F9Y9HC95G");
      </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Music30 Recommendation System">
    <meta property="og:type" content="blog">
  <title>Music30 Recommendation System</title>
<link rel="icon" type="image/png" href="./favicon.png"/>
  <!-- Favicon -->
    <link rel="shortcut icon" target="_blank" href="ðŸŒ€">
    <link rel="stylesheet" type="text/css" target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" target="_blank" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index">
      <div class="Navbar__Btn"><span>ðŸŒ€</span> <span>Home</span></div>
    </a>
                                                                                                                      </nav>
  <header class="Header">
          <div class="Header__Cover">
        <img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff83086ab-2dc7-45bf-be76-c4e354fca05a%2FUntitled.png?table=block&id=20fe4930-8ba5-43bc-bbc2-7a9c5ee7309b">
      </div>
          <div class="Header__Spacer ">
    </div>
        <h1 class="Header__Title">Music30 Recommendation System</h1>
          </header>
      <article id="https://www.notion.so/20fe49308ba543bcbbc27a9c5ee7309b" class="PageRoot"><div id="https://www.notion.so/516cf3bf2cc04493984dcd0c34fba3b9" class="Bookmark"><a target="_blank" href="https://colab.research.google.com/drive/1mfijMYGZV-Ve59H13ezWh_w_K0WCTra0#scrollTo=ej80XDzTYvHc"><h5 class="Bookmark__Title">Google Colaboratory</h5><p class="Bookmark__Link">https://colab.research.google.com/drive/1mfijMYGZV-Ve59H13ezWh_w_K0WCTra0#scrollTo=ej80XDzTYvHc</p></a></div><div id="https://www.notion.so/762dc9fa88da4ec6aa3718cb06712996" class="Bookmark"><a target="_blank" href="https://wandb.ai/sparsh121/SARS%20Music30%20x1/overview?workspace=user-sparsh121"><h5 class="Bookmark__Title">Weights &amp; Biases</h5><p class="Bookmark__Desc">Weights &amp; Biases, developer tools for machine learning</p><p class="Bookmark__Link">https://wandb.ai/sparsh121/SARS%20Music30%20x1/overview?workspace=user-sparsh121</p></a></div><h2 id="https://www.notion.so/236dbb6f2c4e434b9e8e73e7af5ce905" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/236dbb6f2c4e434b9e8e73e7af5ce905"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Introduction</span></span></h2><div id="https://www.notion.so/11f88338daf2448698ebabcda31aa7aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Due to complex user behavior dynamics (listener&#x27;s intent, drift in interest, repeated listening behavior, music reminding, playing order) and lack of music ratings (very few explicit ratings given by the user), the music recommendation systems face challenges in providing optimal music recommendations to the listener. </span></span></p></div><div id="https://www.notion.so/36ddab2a5dc9432cb43dd15fca4d3ee8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The objective is to predict the subsequent user action(s), given the last N actions by the user and other types of information. </span></span></p></div><div id="https://www.notion.so/64914c9b06cb4518bbc22cb4dcbbc32d" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd9115632-fd3d-4158-b6e1-44e1f851e3ca%2FUntitled.png?width=480&amp;table=block&amp;id=64914c9b-06cb-4518-bbc2-2cb4dcbbc32d"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd9115632-fd3d-4158-b6e1-44e1f851e3ca%2FUntitled.png?width=480&amp;table=block&amp;id=64914c9b-06cb-4518-bbc2-2cb4dcbbc32d" style="width:480px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/537998dc0b4b4c45b637618ed8da999c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/537998dc0b4b4c45b637618ed8da999c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Data exploration</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/57170f4136e948cf8a607017c266daaa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">30music </em></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="http://recsys.deib.polimi.it/datasets/">dataset</a></em></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"> downloaded from RecSys Lab official website.</em></span></span></li><li id="https://www.notion.so/22c104f00d474a5a81833a03a3af2e56" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">This dataset contains 31M play events from 45K users over 5.6M tracks collected via Last-FM public API in 1 year, from 20 Jan 2014 to 20 Jan 2015 (about 4GB of uncompressed CSV file).</span></span></li><li id="https://www.notion.so/43cffef90641404e884a240c60229e35" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Play events are grouped into user play sessions, where each session is an ordered list of play events that are assumed to have consequently listened without interruption. Two consecutive play events belong to the same session if the gap is not larger than 800 seconds. The dataset contains 2.7M user sessions, with an average of 11 sessions per user, each one, in turn, composed of 11 tracks, on average.</span></span><div id="https://www.notion.so/9bb4c4f1aba949fbbc165f77b60e568f" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fab5c2e74-2ffc-4ba8-bd44-595d215726ce%2FUntitled.png?width=454&amp;table=block&amp;id=9bb4c4f1-aba9-49fb-bc16-5f77b60e568f"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fab5c2e74-2ffc-4ba8-bd44-595d215726ce%2FUntitled.png?width=454&amp;table=block&amp;id=9bb4c4f1-aba9-49fb-bc16-5f77b60e568f" style="width:454px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></li><li id="https://www.notion.so/b72319f7b30740faa9ef4ce0800b030a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">The 30Music dataset also provides 4.1M user love preferences and 57K user-created playlists. Despite being of undeniable interest for recommender systems, we have not considered explicit feedback from users in our experiments. We focused our attention on implicit feedbacks only - i.e., the user play events and play sessions - since they are the most challenging factors in terms of size.</span></span></li></ul><h2 id="https://www.notion.so/dbfb52bf4c1e4c65a7cfe7838db50cec" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/dbfb52bf4c1e4c65a7cfe7838db50cec"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Methods</span></span></h2><details id="https://www.notion.so/b341fd0400f8429491d734b11ced0537" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Sequence-aware model</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/d98bbc9dfc364cdfa6d30a037dda67dd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Use sequence-aware algorithms that will take into account the user behaviour dynamics.</span></span></p></div></div></details><details id="https://www.notion.so/b973852894fa428a8bb5706c4ff57010" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Popularity based Recommender</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/7846404332474db68e1fb88558987e11" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set. Popularity Recommender simply recommends items ordered by their popularity in the training set. It doesn&#x27;t have any hyper-parameter. </span></span></p></div></div></details><details id="https://www.notion.so/698164af81704b3488c66ae8971080d3" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Frequent Sequential Mining</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/3b005e6287b3421fb494e2719f430b49" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.</span></span></p></div><div id="https://www.notion.so/5d88ad349bc44ea4b1bf927fec5f1f94" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This algorithm extract Frequent Sequential Patterns from all the training sequences. Patterns are having support lower thanÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">minsup</code></span><span class="SemanticString">Â are discarded (support = # occurrences of a pattern in the traning data).Recommendations are then generated by looking for patterns having aÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">prefix</em></span><span class="SemanticString">Â corresponding to the lastÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">[max_context, min_context]</code></span><span class="SemanticString">Â elements in the user profile, taken in order. Matches are then sorted by decreasingÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">confidence</em></span><span class="SemanticString">Â score (ratio between the support of the matched rule and the support of the context). Matches having confidence belowÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">minconf</code></span><span class="SemanticString">Â are discarded.</span></span></p></div><div id="https://www.notion.so/2092d1fba16149f793d13e98dff3d88d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The classÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">FSMRecommender</code></span><span class="SemanticString">Â has the following initialization hyper-parameters:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/f0c33a395e3d477cb2380bc9b1f687e1" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">minsup</code></span><span class="SemanticString">: the minimum support threshold. It is interpreted as relative count if in [0-1], otherwise as an absolute count. NOTE: Relative count required for training with SPFM (faster).</span></span></li><li id="https://www.notion.so/be3ab6687dcc4012b8eb85c9b446c085" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">minconf</code></span><span class="SemanticString">: the minimum confidence threshold. Use to filter irrelevent recommendations.</span></span></li><li id="https://www.notion.so/d9a9e2fb28d8437ea61547d89dd41244" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">max_context</code></span><span class="SemanticString">: the maximum number of items in the user profile (starting from the last) that will be used for lookup in the database of frequent sequences.</span></span></li><li id="https://www.notion.so/98c5e3dbc0d444229fb3ca2143e559d2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">min_context</code></span><span class="SemanticString">: the minimum number of items in the user profile (starting from the last) that will be used for lookup in the database of frequent sequences.</span></span></li><li id="https://www.notion.so/9b41bffb4fa547058c5e287559dae1d7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">spmf_path</code></span><span class="SemanticString">: path to SPMF jar file. If provided, SPFM library will be used for pattern extraction (algorithm: Prefix Span). Otherwise, use pymining, which can be significantly slower depending on the sequence database size.</span></span></li><li id="https://www.notion.so/ded49ea460264d2594a07aed1538f7aa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">db_path</code></span><span class="SemanticString">: path to the sequence database file</span></span></li></ul></div></details><details id="https://www.notion.so/25511c0162034745bbaae4ca80808b93" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Markov Chain Recommender</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/71973712db744a63b666a8eff7c6249b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.This recommender is based on theÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">MarkovChainRecommender</code></span><span class="SemanticString">Â implemented from:</span></span></p></div><div id="https://www.notion.so/79deaf021072492e8849d5d38c23072c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Shani, Guy, David Heckerman, and Ronen I. Brafman. &quot;An MDP-based recommender system.&quot; Journal of Machine Learning Research 6, no. Sep (2005): 1265-1295. Chapter 3-4</em></span></span></p></div><div id="https://www.notion.so/b13006f6dd994a9087137952ef105b34" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This recommender computes the item transition matrices for any Markov Chain having order inÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">[min_order, max_order]</code></span><span class="SemanticString">. Each individual Markov Chain model employs some heuristics like skipping or clustering to deal better with data sparsity. Recommendations are generated by sorting items by their transition probability to being next, given the user profile. The scores coming from different MC are weightedÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">inversely</em></span><span class="SemanticString">Â wrt their order.</span></span></p></div><div id="https://www.notion.so/757a5e4c45944e25aac89d0467fa4fd4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The classÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">MixedMarkovChainRecommender</code></span><span class="SemanticString">Â has the following initialization hyper-parameters:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/d08e1109f34f4ef4ad1c3a92d1acb5e9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">min_order</code></span><span class="SemanticString">: the minimum order of the Mixed Markov Chain</span></span></li><li id="https://www.notion.so/b69965cb296a4a9ca95dd9659126a1b2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">max_order</code></span><span class="SemanticString">: the maximum order of the Mixed Markov Chain</span></span></li></ul></div></details><details id="https://www.notion.so/0fcf30646b45434585ff75724e23eb1f" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Factorized Personalized Markov Chain (FPMC) Recommender</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/845d6094662b43d8986b982bfd5890f7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.This recommender is based on the following paper:</span></span></p></div><div id="https://www.notion.so/baa086727c2b4b2b8ae3171692807ec6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Rendle, S., Freudenthaler, C., &amp; Schmidt-Thieme, L. (2010). Factorizing personalized Markov chains for next-basket recommendation. Proceedings of the 19th International Conference on World Wide Web - WWW â€™10, 811</em></span></span></p></div><div id="https://www.notion.so/e83a4086becb4122ba961c1648e02e9d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In short, FPMC factorizes a personalized order-1 transition tensor using Tensor Factorization with pairwise loss function akin to BPR (Bayesian Pairwise Ranking).</span></span></p></div><div id="https://www.notion.so/f1da349940fc4ed7b8281855d2435b7b" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe9650941-9e40-491f-9d33-33b7cc685878%2Ffpmc.png?width=240&amp;table=block&amp;id=f1da3499-40fc-4ed7-b828-1855d2435b7b"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe9650941-9e40-491f-9d33-33b7cc685878%2Ffpmc.png?width=240&amp;table=block&amp;id=f1da3499-40fc-4ed7-b828-1855d2435b7b" style="width:240px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2aab58fafa5e4e56a534f2767fe404cb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">TF allows to impute values for the missing transitions between items for each user. For this reason, FPMC can be used for generatingÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">personalized</em></span><span class="SemanticString">Â recommendations in session-aware recommenders as well.</span></span></p></div><div id="https://www.notion.so/f445ff8185e34bd9bdbca61292f5962a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In this notebook, you will be able to change the number of latent factors and a few other learning hyper-parameters and see the impact on the recommendation quality.</span></span></p></div><div id="https://www.notion.so/9d484ba1eca0471b8a831931f9012adc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The classÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">FPMCRecommender</code></span><span class="SemanticString">Â has the following initialization hyper-parameters:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/691e80a497f6465d9d9f013241e4633a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">n_factor</code></span><span class="SemanticString">: (optional) the number of latent factors</span></span></li><li id="https://www.notion.so/96c20d9320c74a0086045507bbc2244d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">learn_rate</code></span><span class="SemanticString">: (optional) the learning rate</span></span></li><li id="https://www.notion.so/4a5cc4116a864b94aae05cfad9b57484" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">regular</code></span><span class="SemanticString">: (optional) the L2 regularization coefficient</span></span></li><li id="https://www.notion.so/d218c23963fc4873a178da885cf0fb58" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">n_epoch</code></span><span class="SemanticString">: (optional) the number of training epochs</span></span></li><li id="https://www.notion.so/304a27adf0c14c638d8a750163c226f7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">n_neg</code></span><span class="SemanticString">: (optional) the number of negative samples used in BPR learning</span></span></li></ul></div></details><details id="https://www.notion.so/ef25b1fa14534a5495eb885679f25711" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Prod2Vec Recommender</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/eeb771e98b2b4394aac07a3c40609f65" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.</span></span></p></div><div id="https://www.notion.so/10ae4f55767c4b6c8bf83264a4968374" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This is simplified implementation of the following:</span></span></p></div><div id="https://www.notion.so/35b98056ef8c4effac7130e33e1e42ff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Grbovic, Mihajlo, Vladan Radosavljevic, Nemanja Djuric, Narayan Bhamidipati, Jaikit Savla, Varun Bhagwan, and Doug Sharp. &quot;E-commerce in your inbox: Product recommendations at scale.&quot; In Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 1809-1818. ACM, 2015.</em></span></span></p></div><div id="https://www.notion.so/829d8433f31b484795fedf30f9ab3ba4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This implementation uses theÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">gensim</code></span><span class="SemanticString">Â implementation of Word2Vec to compute item embeddings using the skip-gram model</span></span></p></div><div id="https://www.notion.so/8e6be907788f4251847ea013d26e30c3" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc18df5eb-a9ae-4b70-885f-b0e7ec2c21c1%2Fprod2vec.png?width=336&amp;table=block&amp;id=8e6be907-788f-4251-847e-a013d26e30c3"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc18df5eb-a9ae-4b70-885f-b0e7ec2c21c1%2Fprod2vec.png?width=336&amp;table=block&amp;id=8e6be907-788f-4251-847e-a013d26e30c3" style="width:336px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/6b26ba9be13c4ab49eea74b5caa631cc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Recommendations are generated by returning the k-nearest neighbors of the last items in the user profile, whose relevance is weighted using a simpleÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">exponential decay</em></span><span class="SemanticString">Â (theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">last item</em></span><span class="SemanticString">Â in the user profile is theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">most relevant</em></span><span class="SemanticString">Â one, and theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">first item</em></span><span class="SemanticString">Â theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">least relevant</em></span><span class="SemanticString">).</span></span></p></div><div id="https://www.notion.so/49392491f92c40e8a7c80833f804ac07" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The original paper contains other variants of this algorithm (namely bagged-prod2vec and prod2vec-cluster) which are not subject of this tutorial.</span></span></p></div><div id="https://www.notion.so/20c5b93504e04c2890acce19e3bb408e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The classÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Prod2VecRecommender</code></span><span class="SemanticString">Â has the following initialization hyper-parameters:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4a1bca6fcfbd4c12aec4e939dfdcf36a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">min_count</code></span><span class="SemanticString">: the minimum item frequency. Items less frequent that min_count will be pruned</span></span></li><li id="https://www.notion.so/f951c054d58a4f85b9b9885ec5319955" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">size</code></span><span class="SemanticString">: the size of the embeddings</span></span></li><li id="https://www.notion.so/772e1907e1874932b09e6135e62d82ee" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">window</code></span><span class="SemanticString">: the size of the context window</span></span></li><li id="https://www.notion.so/52b369c4d39041659401fd3b8343b879" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">decay_alpha</code></span><span class="SemanticString">: the exponential decay factor used to discount the similarity scores for items back in the user profile. Lower values mean higher discounting of past user interactions. Allows values in [0-1]</span></span></li><li id="https://www.notion.so/3011348fd9ce4c029005293b75cf0d94" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">workers</code></span><span class="SemanticString">: the number of threads used for training</span></span></li></ul></div></details><details id="https://www.notion.so/cb06c57460a84744b9f7fc599ae0f1dd" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Session-based RNN</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/f33322f6f74842399c401c09006fc73e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.</span></span></p></div><div id="https://www.notion.so/e3bf0a1474f34e09b64a428b5835dcf7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This is aÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">simplified</strong></span><span class="SemanticString">Â interface to Recurrent Neural Network models for Session-based recommendation. Based on the following two papers:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/2c44807c7d6f44cfa8cb9aa19e0088a6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Recurrent Neural Networks with Top-k Gains for Session-based Recommendations, Hidasi and Karatzoglou, CIKM 2018</span></span></li><li id="https://www.notion.so/b336079647ee46c897637b98eefe4e4b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Personalizing Session-based Recommendation with Hierarchical Recurrent Neural Networks, Quadrana et al, Recsys 2017</span></span></li></ul><div id="https://www.notion.so/a32d3b4f108c43f5b1559e3382f1019f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">we will consider the session-based (</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">non-personalized</strong></span><span class="SemanticString">) version of the algorithm.</span></span></p></div><div id="https://www.notion.so/6ef90357cc5642c69519aacfdcde5b57" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F12d8f080-ba33-4ffd-bc8d-b53533bba180%2Fgru4rec.png?width=460&amp;table=block&amp;id=6ef90357-cc56-42c6-9519-aacfdcde5b57"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F12d8f080-ba33-4ffd-bc8d-b53533bba180%2Fgru4rec.png?width=460&amp;table=block&amp;id=6ef90357-cc56-42c6-9519-aacfdcde5b57" style="width:460px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/4e227394f4a04bb3af2d0b63d9dae237" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Each item in the current user session is first encoded either usingÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">1-hot encoding</em></span><span class="SemanticString">Â or aÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">dense embedding vector</em></span><span class="SemanticString">. The item representation is then forwarded to one or more Gated Reucurrent Unit (GRU) layers, which &quot;mix&quot; the information coming from the past steps of the sequence with the representation of the current item. The last hidden state of the network is finally use to compute the likelihood scores for the next items by using one out of several loss functions (e.g. cross-entropy, BPR, TOP1, BPR-max, TOP1-max, etc.).</span></span></p></div><div id="https://www.notion.so/9a57586365924aa9b1f5e9b32d1718f5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">For simplicity, we only supportÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">1-hot encoded</em></span><span class="SemanticString">Â inputs and theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">BPR-max</em></span><span class="SemanticString">Â loss function here.</span></span></p></div><div id="https://www.notion.so/c299c99a55b744c2ab2139e639b5d41b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The hyper-parameters of the model are:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/ee0eac5e940f45ac836d2ba75773deee" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">session_layers</code></span><span class="SemanticString">: number of units per layer used at session level. It has to be a list of integers for multi-layer networks, or a integer value for single-layer networks.</span></span></li><li id="https://www.notion.so/107cbb140f7b4c2495e91bde8d442ce4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">user_layers</code></span><span class="SemanticString">: number of units per layer used at user level. Required only by personalized models. (</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">None</code></span><span class="SemanticString">Â in this case)</span></span></li><li id="https://www.notion.so/cee4aa660ed646d9864021824403ccaf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">batch_size</code></span><span class="SemanticString">: the mini-batch size used in training</span></span></li><li id="https://www.notion.so/c2015bdd1f114bab8b793c1d6b38f03f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">learning_rate</code></span><span class="SemanticString">: the learning rate used in training (Adagrad optimized)</span></span></li><li id="https://www.notion.so/b9550c09af4e470fa92f541fa1e2b4d9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">momentum</code></span><span class="SemanticString">: the momentum coefficient used in training</span></span></li><li id="https://www.notion.so/d3676dbbaf96472fb93df3af5c62dea4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">dropout</code></span><span class="SemanticString">: it&#x27;s a float value for the hidden-layer(s) dropout.</span></span></li><li id="https://www.notion.so/8270b5a938d2448d86d5a2fdd84b61ad" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">epochs</code></span><span class="SemanticString">: number of training epochs</span></span></li><li id="https://www.notion.so/c65133a52758452db17c3c41345c5f98" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">personalized</code></span><span class="SemanticString">: whether to train a personalized model using the HRNN model (</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">False</code></span><span class="SemanticString">Â in this case).</span></span></li></ul><div id="https://www.notion.so/e643419c451d4e5083c446bd13011526" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">NOTE: GRU4Rec originally has many more hyper-parameters. Going through all of them is out, but we suggest to check-out the original source codeÂ </strong></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/hidasib/GRU4Rec"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">here</strong></a></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Â if you are interested.</strong></span></span></p></div></div></details><details id="https://www.notion.so/d20826377039472fb11ef6d0b024bdc1" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Personalized RNN-based Recommender</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/56e8623670ea410a9bf4f524a6f0e485" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.</span></span></p></div><div id="https://www.notion.so/9ff766b7be1c429a8456ce4117bcdb7c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This is aÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">simplified</strong></span><span class="SemanticString">Â interface to Recurrent Neural Network models for Session-based recommendation. Based on the following two papers:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/05f3fbb7695048caaa42a38652d0d06f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Recurrent Neural Networks with Top-k Gains for Session-based Recommendations, Hidasi and Karatzoglou, CIKM 2018</span></span></li><li id="https://www.notion.so/5471bf7534ae4a7f93c5c96b7c386dd6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Personalizing Session-based Recommendation with Hierarchical Recurrent Neural Networks, Quadrana et al, Recsys 2017</span></span></li></ul><div id="https://www.notion.so/55ce025b6efc471ebea0ba3b8d55b6b6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">we will consider the session-aware (</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">personalized</strong></span><span class="SemanticString">) version of the algorithm.</span></span></p></div><div id="https://www.notion.so/cb8ebc746d554b93b702dd5d34dc5096" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F6457a90f-9952-450e-9b9c-bf0cfa749748%2Fhgru4rec.png?width=1342&amp;table=block&amp;id=cb8ebc74-6d55-4b93-b702-dd5d34dc5096"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F6457a90f-9952-450e-9b9c-bf0cfa749748%2Fhgru4rec.png?width=1342&amp;table=block&amp;id=cb8ebc74-6d55-4b93-b702-dd5d34dc5096" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/dbc6cd889274428cb1f3c6905d1cc8bb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Each user session goes through aÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">session</em></span><span class="SemanticString">Â RNN, which modelsÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">short-term</strong></span><span class="SemanticString">Â user preferences. At the end of each session, the state of theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">session</em></span><span class="SemanticString">Â RNN is used to update aÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">user</em></span><span class="SemanticString">Â RNN, which models moreÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">long-term</strong></span><span class="SemanticString">Â user preferences. It&#x27;s state is passed forward to the nextÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">session</em></span><span class="SemanticString">Â RNN, which can now personalize recommendations depending on both short-term and long-term user interests.</span></span></p></div><div id="https://www.notion.so/08a0e098475c4b6f86d4f28b9cece549" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The hyper-parameters of the model are:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/260ffb97dd73451e8c95738cda5757b3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">session_layers</code></span><span class="SemanticString">: number of units per layer used at session level. It has to be a list of integers for multi-layer networks, or a integer value for single-layer networks.</span></span></li><li id="https://www.notion.so/ab7b4d5ac76544dea9779b567d37bb35" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">user_layers</code></span><span class="SemanticString">: number of units per layer used at user level. Required only by personalized models. It has to be a list of integers for multi-layer networks, or a integer value for single-layer networks.</span></span></li><li id="https://www.notion.so/5310affd6f424b528e4c9d35829208f3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">batch_size</code></span><span class="SemanticString">: the mini-batch size used in training</span></span></li><li id="https://www.notion.so/37729c99d26842a5aedf26b585862d4c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">learning_rate</code></span><span class="SemanticString">: the learning rate used in training (Adagrad optimized)</span></span></li><li id="https://www.notion.so/0c2f0387cbcf4990be4bb077976b9d93" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">momentum</code></span><span class="SemanticString">: the momentum coefficient used in training</span></span></li><li id="https://www.notion.so/917985f5bb1f4ea1803c2b66b7f8d3f5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">dropout</code></span><span class="SemanticString">: it&#x27;s a 3-tuple with the values for the dropout of (user hidden, session hidden, user-to-session hidden) layers.</span></span></li><li id="https://www.notion.so/7b426a3a4cb1443c93b60eeef0090b31" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">epochs</code></span><span class="SemanticString">: number of training epochs</span></span></li><li id="https://www.notion.so/7a7d9a2808034cce96cc355b95f14f7f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">personalized</code></span><span class="SemanticString">: whether to train a personalized model using the HRNN model (</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">True</code></span><span class="SemanticString">Â in this case).</span></span></li></ul><div id="https://www.notion.so/70d0218d27e64ee2b64badfbb87d29d5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">NOTE: HGRU4Rec originally has more hyper-parameters. Going through all of them is out from the scope, but we suggest to check-out the original source codeÂ </strong></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/mquad/hgru4rec"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">here</strong></a></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Â in case you are interested.</strong></span></span></p></div></div></details><details id="https://www.notion.so/3a04464f46b742c59b1ac3567540e156" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">KNN-based Recommender</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/c9085a6eb69e4c4db55137a74707c297" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we fit the recommedation algorithm over the sessions in the training set.</span></span></p></div><div id="https://www.notion.so/897333f93ed244bd8372cde8fcce8784" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The classÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">KNNRecommender</code></span><span class="SemanticString">Â takes the following initialization hyper-parameters:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/42153983ef3041eda189fe30bb3165d2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">model</code></span><span class="SemanticString">: One among the following KNN models:</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/61e4d17362b045949cdac0afb64fd231" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">iknn</code></span><span class="SemanticString">: ItemKNN, item-to-item KNN based on theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">last</em></span><span class="SemanticString">Â item in the session to determine the items to be recommended.</span></span></li><li id="https://www.notion.so/4d85c6eae3d8414abb8b636ea0e19c01" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">sknn</code></span><span class="SemanticString">: SessionKNN, compares theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">entire</em></span><span class="SemanticString">Â current session with the past sessions in the training data to determine the items to be recommended.</span></span></li><li id="https://www.notion.so/e49abd95726e459ea317489e03b24ae9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">v-sknn</code></span><span class="SemanticString">: VMSessionKNN, use linearly decayed real-valued vectors to encode the current session, then compares the current session with the past sessions in the training data using the dot-product to determine the items to be recommended.</span></span></li><li id="https://www.notion.so/aec5c33a17474b7ab51cad8cba1c0209" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">s-sknn</code></span><span class="SemanticString">: SeqSessionKNN, this variant also puts more weight on elements that appear later in the session by using a custom scoring function (see the paper by Ludewng and Jannach).</span></span></li><li id="https://www.notion.so/430fd5dd0787458ca30dd3da3d64670c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">sf-sknn</code></span><span class="SemanticString">: SeqFilterSessionKNN, this variant also puts more weight on elements that appear later in the session in a more restrictive way by using a custom scoring function (see the paper by Ludewng and Jannach).</span></span></li></ul></li><li id="https://www.notion.so/21e4eb4be82146da9f33b67a26946e28" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">paramÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">init_args</code></span><span class="SemanticString">: The model initialization arguments. See the following initializations or checkÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">util.knn</code></span><span class="SemanticString">Â for more details on each model:</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/3ceae1d041b745649c2a30c399d01ccf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">iknn</code></span><span class="SemanticString">: ItemKNN(n_sims=100, lmbd=20, alpha=0.5)</span></span></li><li id="https://www.notion.so/3bdd556c98ce4aa39824ee9ea87ccb95" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">sknn</code></span><span class="SemanticString">: SessionKNN(k, sample_size=500, sampling=&#x27;recent&#x27;, similarity=&#x27;jaccard&#x27;, remind=False, pop_boost=0)</span></span></li><li id="https://www.notion.so/25609db73b334830827e95b5ddc21ca0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">v-sknn</code></span><span class="SemanticString">: VMSessionKNN(k, sample_size=1000, sampling=&#x27;recent&#x27;, similarity=&#x27;cosine&#x27;, weighting=&#x27;div&#x27;, dwelling_time=False, last_n_days=None, last_n_clicks=None, extend=False, weighting_score=&#x27;div_score&#x27;, weighting_time=False, normalize=True)</span></span></li><li id="https://www.notion.so/99f3619e4f7041d494884b778826d103" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">s-knn</code></span><span class="SemanticString">: SeqSessionKNN(k, sample_size=1000, sampling=&#x27;recent&#x27;, similarity=&#x27;jaccard&#x27;, weighting=&#x27;div&#x27;, remind=False, pop_boost=0, extend=False, normalize=True)</span></span></li><li id="https://www.notion.so/12f633ff5b024b30b96d601a50bba9a3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">sf-sknn</code></span><span class="SemanticString">: SeqFilterSessionKNN(k, sample_size=1000, sampling=&#x27;recent&#x27;, similarity=&#x27;jaccard&#x27;, remind=False, pop_boost=0,extend=False, normalize=True)</span></span></li></ul></li></ul></div></details><h2 id="https://www.notion.so/df0e71db9dfc477db28d0f23f57a01d9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/df0e71db9dfc477db28d0f23f57a01d9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Evaluation</span></span></h2><div id="https://www.notion.so/66bfcdc27157427da3db0571a4880065" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In the evaluation of sequence-aware recommenders, each sequence in the test set is split into:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/6c0c03c4c27d4d3a80314fcbe7bf58d5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">user profile</em></span><span class="SemanticString">, used to compute recommendations, is composed by the firstÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">k</em></span><span class="SemanticString">Â events in the sequence</span></span></li><li id="https://www.notion.so/1afee0b8d83e4e9aa1c5c6a65e48a57c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">ground truth</em></span><span class="SemanticString">, used for performance evaluation, is composed by the remainder of the sequence.</span></span></li></ul><div id="https://www.notion.so/77f9315461ad4cb194288ccdee20d2ee" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">We can control the dimension of theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">user profile</em></span><span class="SemanticString">Â by assigning aÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">positive</strong></span><span class="SemanticString">Â value toÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">GIVEN_K</code></span><span class="SemanticString">, which correspond to the number of events from the beginning of the sequence that will be assigned to the initial user profile. This ensures that each user profile in the test set will have exactly the same initial size, but the size of the ground truth will change for every sequence.</span></span></p></div><div id="https://www.notion.so/690e29a392ce4e8bbe04d4f162e2fd32" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Alternatively, by assigning aÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">negative</strong></span><span class="SemanticString">Â value toÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">GIVEN_K</code></span><span class="SemanticString">, we will set the initial size of theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">ground truth</em></span><span class="SemanticString">. In this way theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">ground truth</em></span><span class="SemanticString">Â will have the same size for all sequences, but the dimension of the user profile will differ.</span></span></p></div><h3 id="https://www.notion.so/aef479d186fc4b3293c5273eb14e1a06" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" target="_blank" href="#https://www.notion.so/aef479d186fc4b3293c5273eb14e1a06"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Evaluation with sequentially revealed user-profiles</span></span></h3><div id="https://www.notion.so/3a4e9ce28aef439297c18522fb516278" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we evaluate the quality of the recommendations in a setting in which user profiles are revealedÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">sequentially</em></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/fc4e567e3bdf467c888717e07565a934" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F659e6bc9-238e-4a7a-b475-183649a33246%2Futf-8sequential_eval.gif?width=516&amp;table=block&amp;id=fc4e567e-3bdf-467c-8887-17e07565a934"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F659e6bc9-238e-4a7a-b475-183649a33246%2Futf-8sequential_eval.gif?width=516&amp;table=block&amp;id=fc4e567e-3bdf-467c-8887-17e07565a934" style="width:516px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3ecfce93966749bdab1cc3cb38caf614" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">TheÂ user profileÂ starts from the firstÂ GIVEN_KÂ events (or, alternatively, from the lastÂ -GIVEN_KÂ events ifÂ GIVEN_K&lt;0).The recommendations are evaluated against the nextÂ LOOK_AHEADÂ events (theÂ ground truth).TheÂ user profileÂ is next expanded to the nextÂ STEPÂ events, the ground truth is scrolled forward accordingly, and the evaluation continues until the sequence ends. </span></span></p></div><div id="https://www.notion.so/40fa4750bd7548e0986c80f2a44656ce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In typicalÂ next-item recommendation, we start withÂ GIVEN_K=1, generate a set ofÂ alternativesÂ that will evaluated against the next event in the sequence (LOOK_AHEAD=1), move forward of one step (STEP=1) and repeat until the sequence ends. You can set theÂ LOOK_AHEAD=&#x27;all&#x27;Â to see what happens if you had to recommend aÂ whole sequenceÂ instead of a set of a set of alternatives to a user.</span></span></p></div><pre id="https://www.notion.so/a8d1b1a161014d57bb3fbf739bd7c9e6" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>TOPN<span class="token operator">=</span><span class="token number">100</span>
GIVEN_K <span class="token operator">=</span> <span class="token number">1</span>
LOOK_AHEAD <span class="token operator">=</span> <span class="token number">1</span>
STEP<span class="token operator">=</span><span class="token number">1</span>

test_sequences <span class="token operator">=</span> get_test_sequences<span class="token punctuation">(</span>test_data<span class="token punctuation">,</span> GIVEN_K<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{} sequences available for evaluation'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_sequences<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

results <span class="token operator">=</span> evaluation<span class="token punctuation">.</span>sequential_evaluation<span class="token punctuation">(</span>recommender<span class="token punctuation">,</span>
                                          test_sequences<span class="token operator">=</span>test_sequences<span class="token punctuation">,</span>
                                          given_k<span class="token operator">=</span>GIVEN_K<span class="token punctuation">,</span>
                                          look_ahead<span class="token operator">=</span>LOOK_AHEAD<span class="token punctuation">,</span>
                                          evaluation_functions<span class="token operator">=</span>METRICS<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                          top_n<span class="token operator">=</span>TOPN<span class="token punctuation">,</span>
                                          scroll<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># scrolling averages metrics over all profile lengths</span>
                                          step<span class="token operator">=</span>STEP<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Sequential evaluation (GIVEN_K={}, LOOK_AHEAD={}, STEP={})'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>GIVEN_K<span class="token punctuation">,</span> LOOK_AHEAD<span class="token punctuation">,</span> STEP<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> mname<span class="token punctuation">,</span> mvalue <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t{}@{}: {:.4f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mname<span class="token punctuation">,</span> TOPN<span class="token punctuation">,</span> mvalue<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/4cccce034db04f6c80300289e33d96a6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/98c6c0b0ba0a47f1acdeff919bac3da5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Popularity-based Recommender</strong></span></span></p></div><div id="https://www.notion.so/56e9a357f07c4108b3ffcaad4610d1f2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">precision@100: 0.0018	recall@100: 0.1782	mrr@100: 0.0150</span></span></p></div><h3 id="https://www.notion.so/a0ddf4554e3c4f1b9a7c47690527431a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" target="_blank" href="#https://www.notion.so/a0ddf4554e3c4f1b9a7c47690527431a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Evaluation with &quot;static&quot; user-profiles</span></span></h3><div id="https://www.notion.so/2300020979d941e3898161f7543794db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Here we evaluate the quality of the recommendations in a setting in which user profiles are insteadÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">static</em></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/ba83d9f91c5a432893cb721284972616" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">TheÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">user profile</em></span><span class="SemanticString">Â starts from the firstÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">GIVEN_K</code></span><span class="SemanticString">Â events (or, alternatively, from the lastÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">-GIVEN_K</code></span><span class="SemanticString">Â events ifÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">GIVEN_K&lt;0</code></span><span class="SemanticString">).The recommendations are evaluated against the nextÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">LOOK_AHEAD</code></span><span class="SemanticString">Â events (theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">ground truth</em></span><span class="SemanticString">).</span></span></p></div><div id="https://www.notion.so/358eff5ba3b244118b6621c2d491211a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The user profile isÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">not extended</em></span><span class="SemanticString">Â and the ground truthÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">doesn&#x27;t move forward</em></span><span class="SemanticString">. This allows to obtain &quot;snapshots&quot; of the recommendation performance for different user profile and ground truth lenghts.</span></span></p></div><div id="https://www.notion.so/863084410df24e17a9e3018bf8af0cf1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Also here you can set theÂ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">LOOK_AHEAD=&#x27;all&#x27;</code></span><span class="SemanticString">Â to see what happens if you had to recommend aÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">whole sequence</strong></span><span class="SemanticString">Â instead of a set of a set of alternatives to a user.</span></span></p></div><pre id="https://www.notion.so/bc60eb89638b4f30b636bcbd74ef1a89" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>TOPN<span class="token operator">=</span><span class="token number">100</span>
GIVEN_K <span class="token operator">=</span> <span class="token number">1</span>
LOOK_AHEAD <span class="token operator">=</span> <span class="token string">'all'</span>
STEP<span class="token operator">=</span><span class="token number">1</span>

test_sequences <span class="token operator">=</span> get_test_sequences<span class="token punctuation">(</span>test_data<span class="token punctuation">,</span> GIVEN_K<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{} sequences available for evaluation'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_sequences<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

results <span class="token operator">=</span> evaluation<span class="token punctuation">.</span>sequential_evaluation<span class="token punctuation">(</span>recommender<span class="token punctuation">,</span>
                                          test_sequences<span class="token operator">=</span>test_sequences<span class="token punctuation">,</span>
                                          given_k<span class="token operator">=</span>GIVEN_K<span class="token punctuation">,</span>
                                          look_ahead<span class="token operator">=</span>LOOK_AHEAD<span class="token punctuation">,</span>
                                          evaluation_functions<span class="token operator">=</span>METRICS<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                          top_n<span class="token operator">=</span>TOPN<span class="token punctuation">,</span>
                                          scroll<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> 

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Sequential evaluation (GIVEN_K={}, LOOK_AHEAD={}, STEP={})'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>GIVEN_K<span class="token punctuation">,</span> LOOK_AHEAD<span class="token punctuation">,</span> STEP<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> mname<span class="token punctuation">,</span> mvalue <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t{}@{}: {:.4f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mname<span class="token punctuation">,</span> TOPN<span class="token punctuation">,</span> mvalue<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/67259efc90ce45048bc01e75a1b8cb8c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/b277fbea60c9468e8712ff9bd858197b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Popularity-based Recommender</strong></span></span></p></div><div id="https://www.notion.so/1337448959cc4df2a7cd0ff944fb1b7f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">precision@100: 0.0086	recall@100: 0.1777	mrr@100: 0.0491</span></span></p></div><h2 id="https://www.notion.so/8f334902e1094c9f94b470425ec6cbb1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/8f334902e1094c9f94b470425ec6cbb1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Next-item Recommendation evaluation</span></span></h2><div id="https://www.notion.so/bc6caaa500804abcad3b342df0306ef0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">We propose to analyse the performance of the recommender system in the scenario ofÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">next-item recommendation</em></span><span class="SemanticString">Â over the following dimensions:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/621dc356290042a28932c34e1b2aaeaf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">length</em></span><span class="SemanticString">Â of theÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">recommendation list</strong></span></span></li></ul><pre id="https://www.notion.so/ed7303ebf4b448bd90d211fbd44429c2" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>GIVEN_K <span class="token operator">=</span> <span class="token number">1</span>
LOOK_AHEAD <span class="token operator">=</span> <span class="token number">1</span>
STEP <span class="token operator">=</span> <span class="token number">1</span>
topn_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span>

test_sequences <span class="token operator">=</span> get_test_sequences<span class="token punctuation">(</span>test_data<span class="token punctuation">,</span> GIVEN_K<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{} sequences available for evaluation'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_sequences<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

res_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> topn <span class="token keyword">in</span> topn_list<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Evaluating recommendation lists with length: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>topn<span class="token punctuation">)</span><span class="token punctuation">)</span>
    res_tmp <span class="token operator">=</span> evaluation<span class="token punctuation">.</span>sequential_evaluation<span class="token punctuation">(</span>recommender<span class="token punctuation">,</span>
                                              test_sequences<span class="token operator">=</span>test_sequences<span class="token punctuation">,</span>
                                              given_k<span class="token operator">=</span>GIVEN_K<span class="token punctuation">,</span>
                                              look_ahead<span class="token operator">=</span>LOOK_AHEAD<span class="token punctuation">,</span>
                                              evaluation_functions<span class="token operator">=</span>METRICS<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                              top_n<span class="token operator">=</span>topn<span class="token punctuation">,</span>
                                              scroll<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># here we average over all profile lengths</span>
                                              step<span class="token operator">=</span>STEP<span class="token punctuation">)</span>
    mvalues <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res_tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    res_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>topn<span class="token punctuation">,</span> mvalues<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># show separate plots per metric</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ncols<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">)</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
res_list_t <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>res_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> midx<span class="token punctuation">,</span> metric <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mvalues <span class="token operator">=</span> <span class="token punctuation">[</span>res_list_t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>midx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>res_list_t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    ax <span class="token operator">=</span> axes<span class="token punctuation">[</span>midx<span class="token punctuation">]</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>topn_list<span class="token punctuation">,</span> mvalues<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>metric<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span>topn_list<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'List length'</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/d35ad14105aa436291a706eec7353ac7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/b5980b3780c24669b2ae54d8f8f7aab6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">theÂ </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">length</em></span><span class="SemanticString">Â of theÂ </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">user profile</strong></span><span class="SemanticString">.</span></span></li></ul><pre id="https://www.notion.so/77406f84fb7d49759444fdb7d0870922" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>given_k_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
LOOK_AHEAD <span class="token operator">=</span> <span class="token number">1</span>
STEP <span class="token operator">=</span> <span class="token number">1</span>
TOPN <span class="token operator">=</span> <span class="token number">20</span>

<span class="token comment"># ensure that all sequences have the same minimum length </span>
test_sequences <span class="token operator">=</span> get_test_sequences<span class="token punctuation">(</span>test_data<span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>given_k_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'{} sequences available for evaluation'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>test_sequences<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

res_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> gk <span class="token keyword">in</span> given_k_list<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Evaluating profiles having length: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>gk<span class="token punctuation">)</span><span class="token punctuation">)</span>
    res_tmp <span class="token operator">=</span> evaluation<span class="token punctuation">.</span>sequential_evaluation<span class="token punctuation">(</span>recommender<span class="token punctuation">,</span>
                                              test_sequences<span class="token operator">=</span>test_sequences<span class="token punctuation">,</span>
                                              given_k<span class="token operator">=</span>gk<span class="token punctuation">,</span>
                                              look_ahead<span class="token operator">=</span>LOOK_AHEAD<span class="token punctuation">,</span>
                                              evaluation_functions<span class="token operator">=</span>METRICS<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                              top_n<span class="token operator">=</span>TOPN<span class="token punctuation">,</span>
                                              scroll<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># here we stop at each profile length</span>
                                              step<span class="token operator">=</span>STEP<span class="token punctuation">)</span>
    mvalues <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res_tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    res_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>gk<span class="token punctuation">,</span> mvalues<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># show separate plots per metric</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ncols<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">)</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
res_list_t <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>res_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> midx<span class="token punctuation">,</span> metric <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>METRICS<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mvalues <span class="token operator">=</span> <span class="token punctuation">[</span>res_list_t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>midx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>res_list_t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    ax <span class="token operator">=</span> axes<span class="token punctuation">[</span>midx<span class="token punctuation">]</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>given_k_list<span class="token punctuation">,</span> mvalues<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>metric<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span>given_k_list<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Profile length'</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/dd4984919f654f9da0f47f51be6cf2ec" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/dc90632a5bd64d5186cdb4f196d0ee0e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">NOTE: This evaluation is by no means exhaustive, as different the hyper-parameters of the recommendation algorithm should beÂ carefully tunedÂ before drawing any conclusions. </em></span></span></p></div><h2 id="https://www.notion.so/2a76e69fa8a64186b90c095f9f4f035b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/2a76e69fa8a64186b90c095f9f4f035b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">References</span></span></h2><ol class="NumberedListWrapper"><li id="https://www.notion.so/9329b50498ce4f209df15d4ba1ff808d" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://github.com/mquad/sars_tutorial">https://github.com/mquad/sars_tutorial</a></span></span></li><li id="https://www.notion.so/2e645dcadb6d4d948e18cfebf8d00c43" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://arxiv.org/pdf/1802.08452.pdf">https://arxiv.org/pdf/1802.08452.pdf</a></span></span></li><li id="https://www.notion.so/cb43e3765ebf43f894b028c06a70c7a8" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://recsys.acm.org/wp-content/uploads/2019/09/recsys-19-material-predictability.pdf">https://recsys.acm.org/wp-content/uploads/2019/09/recsys-19-material-predictability.pdf</a></span></span></li><li id="https://www.notion.so/0d26d30048ba4e9ab58cf807b09043bc" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://mquad.github.io/static/papers/2015-large-scale-music-rec.pdf">https://mquad.github.io/static/papers/2015-large-scale-music-rec.pdf</a></span></span></li><li id="https://www.notion.so/19771a1aa8424e5fa7c1593f0405ba06" class="NumberedList" value="5"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="http://ceur-ws.org/Vol-1441/recsys2015_poster13.pdf">http://ceur-ws.org/Vol-1441/recsys2015_poster13.pdf</a></span></span></li><li id="https://www.notion.so/2fe06904e32a4ef3acab6e9d4156998a" class="NumberedList" value="6"><span class="SemanticStringArray"><span class="SemanticString">Evaluation of Session-based Recommendation Algorithms [</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" target="_blank" href="https://arxiv.org/abs/1803.09587">arXiv:1803.09587</a></span><span class="SemanticString">]</span></span></li></ol><div id="https://www.notion.so/f33ad5da0f85412399a92bb9d0608888" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/2c1a145322c543549a1be7df9a239d1a" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2e1677d0-a7d6-4adc-91ad-8ef66fe36590%2FUntitled.png?width=668&amp;table=block&amp;id=2c1a1453-22c5-4354-9a1b-e7df9a239d1a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2e1677d0-a7d6-4adc-91ad-8ef66fe36590%2FUntitled.png?width=668&amp;table=block&amp;id=2c1a1453-22c5-4354-9a1b-e7df9a239d1a" style="width:668px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/ec9dfe7b94754b84a4441e3d77d4505f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fbe1316ccf454ff99fb454466fb21f7d" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4a933c45-eb33-45f0-aa76-295cc29821ee%2FUntitled.png?width=665&amp;table=block&amp;id=fbe1316c-cf45-4ff9-9fb4-54466fb21f7d"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4a933c45-eb33-45f0-aa76-295cc29821ee%2FUntitled.png?width=665&amp;table=block&amp;id=fbe1316c-cf45-4ff9-9fb4-54466fb21f7d" style="width:665px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/656d31dc563e473f85244bc9b7b8b576" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/2a7afbfab62d4bf1801bd65be5ca20e7" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8dbec150-0aa8-4015-be48-28c123315944%2FUntitled.png?width=640&amp;table=block&amp;id=2a7afbfa-b62d-4bf1-801b-d65be5ca20e7"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8dbec150-0aa8-4015-be48-28c123315944%2FUntitled.png?width=640&amp;table=block&amp;id=2a7afbfa-b62d-4bf1-801b-d65be5ca20e7" style="width:640px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/d68cef9a116440d295305d8b3f44577a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" target="_blank" href="#https://www.notion.so/d68cef9a116440d295305d8b3f44577a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">FSM</span></span></h2><div id="https://www.notion.so/d6491df0128a4aa6ae3f1286327a4ecf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0ebaa89df755434393c85b5a1dbc9ea4" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fdcc41214-daf9-471a-b429-09023c46e774%2FUntitled.png?width=581&amp;table=block&amp;id=0ebaa89d-f755-4343-93c8-5b5a1dbc9ea4"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fdcc41214-daf9-471a-b429-09023c46e774%2FUntitled.png?width=581&amp;table=block&amp;id=0ebaa89d-f755-4343-93c8-5b5a1dbc9ea4" style="width:581px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/fdb0aee2026f471d9798af1d699389e6" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F749ff3ca-e316-4d19-8b33-833a15331ca6%2FUntitled.png?width=822&amp;table=block&amp;id=fdb0aee2-026f-471d-9798-af1d699389e6"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F749ff3ca-e316-4d19-8b33-833a15331ca6%2FUntitled.png?width=822&amp;table=block&amp;id=fdb0aee2-026f-471d-9798-af1d699389e6" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2d9b67258d1847c2b9ee1e2eab4be549" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/eff365148365443988f77ebde860d126" class="Image Image--PageWidth"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F218aa9a9-8972-4d61-a08e-9b5afef89120%2FUntitled.png?width=780&amp;table=block&amp;id=eff36514-8365-4439-88f7-7ebde860d126"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F218aa9a9-8972-4d61-a08e-9b5afef89120%2FUntitled.png?width=780&amp;table=block&amp;id=eff36514-8365-4439-88f7-7ebde860d126" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/82a5037d729e437097af0a19a188e2ba" class="Image Image--Normal"><figure><a target="_blank" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5a909ae4-9bd0-46d3-b533-e3ca7a769157%2FUntitled.png?width=568&amp;table=block&amp;id=82a5037d-729e-4370-97af-0a19a188e2ba"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5a909ae4-9bd0-46d3-b533-e3ca7a769157%2FUntitled.png?width=568&amp;table=block&amp;id=82a5037d-729e-4370-97af-0a19a188e2ba" style="width:568px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></article>  <footer class="Footer">
        <div>&copy; RecoBlog 2021</div>
        <div>&centerdot;</div>
        <div>Powered by <a target="_blank" href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>